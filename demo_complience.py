import docx2txt
import requests
import json

def extract_docx(file_path):
    """
    Извлекает текст из .docx файла с помощью docx2txt
    """
    try:
        text = docx2txt.process(file_path)
        return text
    except Exception as e:
        print(f"Ошибка при чтении файла: {e}")
        return None
    

YC_GPT_URL = "https://llm.api.cloud.yandex.net/foundationModels/v1/completion"
YC_FOLDER_ID = "b1gvjms07lsr4hfhq8v3"
YC_API_KEY = "AQVNzGQyyfsE_0ScOUIqgCbaDjPBQjYEBL7-h_i3"
    
def determine_score(resume_text: str, vacancy_text: str) -> int:
    """
    Анализ резюме против вакансии через YandexGPT.
    Возвращает процент соответствия.
    """
    headers = {
        "Authorization": f"Api-Key {YC_API_KEY}",
        "Content-Type": "application/json",
    }
    data = {
        "modelUri": f"gpt://{YC_FOLDER_ID}/yandexgpt/latest",
        "completionOptions": {
            "stream": False,
            "temperature": 0.2,
            "maxTokens": 1000
        },
        "messages": [
            {
                "role": "system",
                "text": (
                    "Ты HR-специалист. Сравни резюме и вакансию и оцени, "
                    "насколько кандидат подходит. Верни только число процентов (0–100)."
                )
            },
            {
                "role": "user",
                "text": f"Вакансия:\n{vacancy_text}\n\nРезюме:\n{resume_text}"
            }
        ]
    }

    resp = requests.post(YC_GPT_URL, headers=headers, data=json.dumps(data))
    resp.raise_for_status()
    result = resp.json()

    # Достаём текст ответа
    answer = result["result"]["alternatives"][0]["message"]["text"]

    # Пробуем выделить число
    try:
        percent = int("".join(ch for ch in answer if ch.isdigit()))
        # Преобразуем проценты в дробное число от 0.0 до 1.0
        return max(0.0, min(1.0, percent / 100.0))
    except ValueError:
        return 0.0

# Использование
vacation_text = extract_docx("AI HR\Описание ИТ.docx")
resume_text = extract_docx('AI HR\Образец резюме 1 Ведущий специалист ИТ.docx')
print(determine_score(vacation_text,resume_text))
resume_text = extract_docx('AI HR\Образец резюме 2 Ведущий специалист ИТ.docx')
print(determine_score(vacation_text,resume_text))

vacation_text = extract_docx("AI HR\Описание бизнес аналитик.docx")
resume_text = "Проживает: Москва Гражданство: Россия, есть разрешение на работу: Россия Не готова к переезду, готова к редким командировкам Желаемая должность и зарплата Бизнес / Системный аналитик Специализации: — Бизнес-аналитик— Менеджер продукта— Системный аналитик Занятость: полная занятость График работы: полный день, гибкий график, удаленная работа Желательное время в пути до работы: не имеет значения Опыт работы —18 лет Ноябрь 2021 — настоящее время 3 года 9 месяцев Raiffeisenbank Москва, www.raiffeisen.ru Финансовый сектор • Банк Бизнес-аналитик - Автоматизация проверок для оценки риска мошенничества по кредитным заявкам. - Управление требованиями - Взаимодействие с заинтересованными лицами - Управление знаниями - Проектирование систем - Моделирование бизнес-процессов и бизнес-правил - Участие в поддержке системы на всех стадиях жизненного цикла - Участие в создании пользовательского интерфейса - Участие в решении инцидентов, тестировании, демонстрации нового функционала; - Участие в формировании бэклога команды. - Участие в оптимизации внутренних командных процессов Октябрь 2016 — Ноябрь 2021 5 лет 2 месяца Raiffeisenbank Москва, www.raiffeisen.ru Финансовый сектор • Банк Риск-менеджер - Оценка кредитных рисков по результатам финансового анализа клиента; - Подготовка заключения по результатам финансового анализа заемщика; - Подбор оптимального варианта кредитования; - Подготовка кредитных заявок и материалов для принятия решения кредитными организациями о финансировании клиента; - выявление проблемных клиентов Сентябрь 2014 — Июль 2016 1 год 11 месяцев Банк ВТБ (ПАО) Москва, www.vtbcareer.com Финансовый сектор • Управляющая, инвестиционная компания (управление активами) • Банк Главный кредитный аналитик -проведение встреч с клиентами с целью выявления потребностей и структурирования сделок; - выезд на место ведения бизнеса, сбор первичной информации; -анализ финансово-хозяйственной деятельности заемщика по методике ЕБРР; -первичный осмотр залога, поиск аналогов и оценка; - подготовка заключения по итогам анализа и защита сделки на кредитном комитете; Октябрь 2011 — Август 2014 2 года 11 месяцев Сбер Москва, rabota.sber.ru/ Финансовый сектор • Банк Кредитный инспектор отдела продаж малого бизнеса -проведение встреч с клиентами с целью выявления потребностей и структурирования сделок; - выезд на место ведения бизнеса, сбор первичной информации; -анализ финансово-хозяйственной деятельности заемщика по управленческой отчетности; -первичный осмотр залога и последующие его мониторинг; - подготовка заключения по итогам анализа и защита сделки на кредитном комитете; - подготовка кредитно-обеспечительной документации; - выдача и сопровождение кредита, финансовый мониторинг, мониторинг выполнения дополнительных условий; - работа с проблемными активами. Март 2010 — Октябрь 2011 1 год 8 месяцев Сбер Москва, rabota.sber.ru/ Финансовый сектор • Банк Клиентский менеджер - Привлечение клиентов и заключение договоров на обслуживание; - Активные продажи банковских кредитных и некредитных продуктов среди клиентов юридических лиц; - Сопровождение клиентской базы; - Кредитование малого бизнеса; - Анализ финансово-хозяйственной деятельности организаций; - Сопровождение кредитных сделок. Июнь 2007 — Март 2010 2 года 10 месяцев Сбер Москва, rabota.sber.ru/ Финансовый сектор • Банк Специалист по обслуживанию юридических лиц - Расчетно-кассовое обслуживание юридиских лиц; - Открытие и ведение счетов юридических лиц; - Осуществление контроля по линии финансового мониторинга; - Осуществление валютного контроля по счетам юридиских лиц; - Перевод иностранной валюты за пределы РФ; - Ведение отчетности по ф. 402, ф. 664 - Выдача/приём наличной иностранной валюты; - Обслуживание бизнес-счетов юридических лиц, в т.ч. приём/выдача бизнес-карт; - Обслуживание счетов юридических лиц - нерезидентов Образование Высшее 2012 ГОУ ВПО \"Государственный университет управления\" менеджмент организации, менеджер 2007 ГОУ \"Банковский колледж № 1\" банковское дело, специалист банковского дела Навыки Знание языков Русский — Родной Навыки SQL Работа с требованиями Взаимодействие со стейкхолдерами Декомпозиция задач Коммуникативные навыки User Story Управление знаниями Управление бэклогом Приемочное тестирование"
print(determine_score(vacation_text,resume_text))
resume_text = "Проживает: Москва, м. Крылатское Гражданство: Россия Не готов к переезду, готов к командировкам Желаемая должность и зарплата Аналитик Специализации: — Бизнес-аналитик Занятость: полная занятость, проектная работа График работы: полный день, гибкий график, удаленная работа Желательное время в пути до работы: не более часа Опыт работы —11 месяцев Октябрь 2024 — настоящее время 11 месяцев ПАО СБЕРБАНК Бизнес-аналитик Обязанности: -Выявлял потребности заказчика, моделировал бизнес-процессы, выполнял прототипирование пользовательского интерфейса, готовил Т3 для команды разработки -Проводил анализ, валидацию, документирование бизнес, функциональных, нефункциональных требований на изменение текущих и запуск новых технологических процессов Банка (Use case, User Story, CJM) - Декомпозировал бизнес-требования до формализованных задач командам разработки на изменение/внедрение IT систем -Работал со следующими инструментами прототипирования: Miro, draw.io и whiteboard -Занимался имплементацией self-service no code платформы на базе Camunda (BPMN 2.0), предназначенной для управления потоками данных в Кредитной машине Банка -Создавал и структурировал документацию в рамках команд, интегрировал задачи и проекты с соответсвующими страницами (Confluence, Jira) -Проводил мероприятия связанные с тестированием разработанных решений, демонстрацией решений для заказчиков и сбор обратной связи -Проводил UX исследования и расписывал варианты улучшения клиентского опыта -Описывал Т3 для продуктовых дизайнеров и привлекал внешние ресурсы дизайна на проекты -Инициировал проведение CustDev для будущих пользователей платформы самообслуживания, что позволило улучшить пользовательский интерфейс панели управления - Описывал as is / to be, use case, user story - Проводил регулярную коммуникацию с команды разработчиков для оперативного решения возникающих вопросов и устранения несоответствий - Поддерживал актуальность документации по требованиям на протяжении всего проекта Образование Высшее 2025 МГУ, Москва Бизнес-информатика , Бизнес-информатика 2019 МГТУ им. Баумана Автоматизация Повышение квалификации, курсы 2025 Школа бизнес анализа (Пульс) Сбербанк, Бизнес аналитик Навыки Знание языков Русский — Родной Английский — B1 — Средний Навыки UX-исследования AS IS/TO BE mapping User Story Use case Анализ обратной связи Анализ бизнес-процессов Многозадачность Организаторские навыки Стратегическое мышление Английский язык Управление ресурсами Управление бэклогом BPMN Опыт вождения Имеется собственный автомобиль Права категории B Дополнительная информация Обо мне"
print(determine_score(vacation_text,resume_text))